<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
		<meta http-equiv="Content-Script-Type" content="text/javascript">
		<title th:text="#{view.editUInfoMIn.pagetitle}"></title>
		<link th:href="@{/css/semantic.min.css}" rel="stylesheet" type="text/css" />
    	<link th:href="@{/css/header.css}" rel="stylesheet" type="text/css" />
    	<link th:href="@{/css/originalIndex.css}" rel="stylesheet" type="text/css" />
    	<link th:href="@{/css/topbottom.css}" rel="stylesheet" type="text/css" />
    	<script type="text/javascript" th:src="@{/js/jquery-3.4.1.min.js}"></script>
		<script type="text/javascript" th:src="@{/js/jquery-ui.min.js}"></script>
		<link th:href="@{/css/jquery-ui.css}" rel="stylesheet" type="text/css" />
    	<script type="text/javascript" th:src="@{/js/datepicker-ja.js}"></script>
    	<script type="text/javascript" th:src="@{/js/scroll.js}"></script>
    	
	</head>
	<body>
		<!-- 外部ヘッダーファイル読み込み -->
		<div th:insert="header :: header"></div>
		<!-- 小見出しを各々のページで書き換え -->
		<br>
		<div class="komidasi">
			<h3 th:text="#{view.editUInfoMIn.pagetitle}"></h3>
		</div>
		<div class="ui hidden divider"></div><!-- 一行スペース入れてる -->
		
		<!---------------------------- 以下、本体-------------------------------------------------------------------------->

		<div class="ui container">
			<div class="ui center aligned container">
				<h3 class="editmultititle" th:text="#{view.text.editMultiInput}"></h3>
				<h3 class="edituserinfomultiinput_error" th:text="${errormsg}"></h3>
			</div>
			<form action="/editusersmulti/confirm" th:object="${editUserInfoMultiForm}"  method="POST" class="ui form" name="form">
				<div class="lefttopbutten">
					<button type="submit" class="ui inverted blue button editmultisubmit" name="delete"><p th:text="#{view.btn.del}"></button>
				</div>
				<table class="ui celled table">
					<thead class="delete">
						<tr>
							<th>
								<span class="ui checkbox">
									    <input type="checkbox" name="all" onClick="AllChecked();" />
									<label></label>
								</span>
							</th>
							<th th:text="#{view.tablelabel.uId}"></th>
							<th th:text="#{view.tablelabel.pass}"></th>
							<th th:text="#{view.tablelabel.name}"></th>
							<th th:text="#{view.tablelabel.gender}"></th>
							<th th:text="#{view.tablelabel.birthday}"></th>
							<th th:text="#{view.tablelabel.grade}"></th>
							<th th:text="#{view.tablelabel.adminFlg}"></th>
						</tr> 
					</thead>
					<th:block th:if="${errlist}" th:each="user, stat : ${userlist}">
				    <tr>
						<td>
							<span class="ui checkbox">		
								<input type="checkbox" th:value="${user.user_id}" th:name="inputMultiCheck" th:field="*{inputMultiCheck}" >
								<label for="multiChecks' + __${stat.index}__ + '"></label>
							</span>
						</td>
						<td th:data-label="#{view.tablelabel.uId}">
	            			<p th:text="${user.user_id}"></p>
	                		<input type="hidden" th:name="'userList[' + __${stat.index}__ + '].user_id'" th:value="${user.user_id}">
	            		</td>
	            		<td th:data-label="#{view.tablelabel.pass}">
	                		<input type="text" name="user_pass" th:name="'userList[' + __${stat.index}__ + '].user_pass'" th:value="${user.user_pass}">
	                		<span th:if="${errlist[__${stat.index}__][0]}" th:text="${errlist[__${stat.index}__][0]}" class="index_input_error"></span>
	            		</td>
				        <td th:data-label="#{view.tablelabel.name}">
	                		<input type="text" name="user_name" th:name="'userList[' + __${stat.index}__ + '].user_name'" th:value="${user.user_name}">
	                		<span th:if="${errlist[__${stat.index}__][1]}" th:text="${errlist[__${stat.index}__][1]}" class="index_input_error"></span>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.gender}">
	            			<div th:insert="selectbox :: editgender"></div>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.birthday}">
	            			<input type="text" class="datepicker" placeholder="#{view.ph.birthday}" readonly="readonly" th:name="'userList[' + __${stat.index}__ + '].birthday'" th:value="${user.birthday}">
	                		<span th:if="${errlist[__${stat.index}__][2]}" th:text="${errlist[__${stat.index}__][2]}" class="index_input_error"></span>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.grade}">
	                		<div th:insert="selectbox :: editgrade"></div>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.adminFlg}">
	                		<div th:insert="selectbox :: editadminflg"></div>
	            		</td>
	        		</tr>
	        		</th:block>
	        		<th:block th:unless="${errlist}">
	        		<tr th:each="user, stat : ${userlist}">
						<td>
							<span class="ui checkbox">
								<input type="checkbox" th:value="${user.user_id}" th:name="inputMultiCheck" th:field="*{inputMultiCheck}" >
								<label for="multiChecks' + __${stat.index}__ + '"></label>
							</span>
						</td>
						
						<td th:data-label="#{view.tablelabel.uId}">
	            			<p th:text="${user.user_id}"></p>
	                		<input type="hidden" th:name="'userList[' + __${stat.index}__ + '].user_id'" th:value="${user.user_id}">
	            		</td>
	            		<td th:data-label="#{view.tablelabel.pass}">
	                		<input type="text" name="user_pass" th:name="'userList[' + __${stat.index}__ + '].user_pass'" th:value="${user.user_pass}">
	            		</td>
				        <td th:data-label="#{view.tablelabel.name}">
	                		<input type="text" name="user_name" th:name="'userList[' + __${stat.index}__ + '].user_name'" th:value="${user.user_name}">
	            		</td>
	            		<td th:data-label="#{view.tablelabel.gender}">
	            			<div th:insert="selectbox :: editgender"></div>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.birthday}">
	            			<input type="text" class="datepicker" placeholder="#{view.ph.birthday}" readonly="readonly" th:name="'userList[' + __${stat.index}__ + '].birthday'" th:value="${user.birthday}" onClick="DisChecked();">
	            		</td>
	            		<td th:data-label="#{view.tablelabel.grade}">
	                		<div th:insert="selectbox :: editgrade"></div>
	            		</td>
	            		<td th:data-label="#{view.tablelabel.adminFlg}">
	                		<div th:insert="selectbox :: editadminflg"></div>
	            		</td>
	        		</tr>
	        		</th:block>
				</table>
				<div class="leftbutten">
					<div class="lefttopbutten">
						<button type="submit" class="ui inverted blue button editmultisubmit" name="delete"><p th:text="#{view.btn.del}"></button>
					</div>
				</div>
				<div class="centerbutten">
					<button type="submit" class="ui inverted blue button editmultisubmit" name="update"><p th:text="#{view.btn.confirm}"></button>
					<a href="/search_return">
						<button type="button" class="ui inverted blue button"><p th:text="#{view.btn.return}"></button>
					</a>
				</div>
			</form>
			<p id="btm"></p>
		</div>
		<p id="pageTop"><a href="/editUserInfoMultiInput"><i class="arrow up icon"></i></a></p>
  		<p id="pageBottom"><a href="#btm"><i class="arrow down icon"></i></a></p>
		<br><br><br>
		<script type="text/javascript">
		  // 「全て選択」チェックで全てにチェック付く
		  function AllChecked(){
		    var all = document.form.all.checked;
		    for (var i=0; i<document.form.inputMultiCheck.length; i++){
		      document.form.inputMultiCheck[i].checked = all;
		    }
		  }
	
		  // 一つでもチェックを外すと「全て選択」のチェック外れる
		  function　DisChecked(){
		    var checks = document.form.inputMultiCheck;
		    var checksCount = 0;
		    for (var i=0; i<checks.length; i++){
		      if(checks[i].checked == false){
		        document.form.all.checked = false;
		      }else{
		        checksCount += 1;
		        if(checksCount == checks.length){
		          document.form.all.checked = true;
		        }
		      }
		    }
		  }
		</script>
	</body>
</html>